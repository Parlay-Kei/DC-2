#===============================================================================
# Direct Cuts - Fastlane Matchfile
#===============================================================================
# Match (code signing) configuration for iOS.
# This manages iOS certificates and provisioning profiles via a Git repository.
#
# Setup Guide:
# 1. Create a private Git repo for certificates
# 2. Set MATCH_GIT_URL environment variable
# 3. Run: fastlane match development
# 4. Run: fastlane match appstore
#
# Documentation: https://docs.fastlane.tools/actions/match/
#===============================================================================

#-------------------------------------------------------------------------------
# Git Repository for Certificates
#-------------------------------------------------------------------------------

# Private Git repository URL for storing encrypted certificates
# Example: git@github.com:directcuts/ios-certificates.git
git_url(ENV["MATCH_GIT_URL"] || "git@github.com:directcuts/ios-certificates.git")

# Git branch to use (default: master)
git_branch("main")

#-------------------------------------------------------------------------------
# Storage Configuration
#-------------------------------------------------------------------------------

# Storage mode: git, google_cloud, s3, or gitlab_secure_files
storage_mode("git")

#-------------------------------------------------------------------------------
# Certificate Types
#-------------------------------------------------------------------------------

# Type of provisioning profile to use
# Options: appstore, adhoc, development, enterprise
type("appstore")

#-------------------------------------------------------------------------------
# App Configuration
#-------------------------------------------------------------------------------

# Bundle identifier(s) to create provisioning profiles for
app_identifier(["com.directcuts.app"])

# Apple Developer Team ID
team_id(ENV["APPLE_TEAM_ID"] || "XXXXXXXXXX")

#-------------------------------------------------------------------------------
# Security Settings
#-------------------------------------------------------------------------------

# Don't generate new certificates/profiles automatically
# Set to false initially to bootstrap, then true for safety
readonly(ENV["MATCH_READONLY"] == "true")

# Clone via SSH or HTTPS
# Use SSH for CI/CD environments with deploy keys
clone_branch_directly(true)

# Shallow clone to speed up operations
shallow_clone(true)

#-------------------------------------------------------------------------------
# Additional Settings
#-------------------------------------------------------------------------------

# Skip docs generation to speed up
skip_docs(true)

# Verbose output for debugging
verbose(ENV["FASTLANE_VERBOSE"] == "true")

# Platform: ios or macos
platform("ios")

#-------------------------------------------------------------------------------
# Keychain Configuration (for CI/CD)
#-------------------------------------------------------------------------------

# For CI environments, use a temporary keychain
# keychain_name(ENV["MATCH_KEYCHAIN_NAME"] || "login.keychain")
# keychain_password(ENV["MATCH_KEYCHAIN_PASSWORD"])
